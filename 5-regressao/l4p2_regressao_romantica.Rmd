---
title: "l4p2_regressao_romantica"
author: "devjaynemorais"
date: "8 de julho de 2019"
output: 
  html_notebook:
    theme: lumen
    fig_width: 7
    toc: true
    toc_float: true
    code_folding: hide
editor_options: 
  chunk_output_type: inline
---
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(lubridate)
library(ggbeeswarm)
library(ggridges)
library(ggplot2)
library(scales)

library(GGally)
library(pscl)
library(broom)
library(modelr) # devtools::install_github("hadley/modelr")

theme_set(theme_bw())
```


```{r}
dados = read_csv("speed-dating/speed-dating2.csv")

dados = dados %>% mutate(match = ifelse(dec == "yes", 1, 0))
```

Análise exploratória dos dados:

```{r}
dados  %>%
  ggplot(aes(x = dec, fill = dec)) + 
    geom_bar(width=.5) +
    labs(
        title = "Distribuição de Match",
        y = "Quantidade",
        x = "Match" 
      ) + 
  guides(fill=guide_legend("Deu Match?"))


```
É possível observar que há uma quantidade bem menor de match correspondido do que não correspondido.

```{r}
dados %>%
  #na.omit(samerace) %>%
  ggplot(aes(x = like)) +
  geom_histogram(color = "black",
                 fill = "grey",
                 breaks=seq(0, 10, by = 1)) +
  scale_x_continuous(breaks=seq(0, 10, by = 1)) +
  scale_y_continuous(breaks=seq(0, 10000, by = 100)) +
  labs(x= "Quanto p1 gostou de p2 (like)",
       y = "Quantidade")
``` 

```{r}
dados %>%
  #na.omit(samerace) %>%
  ggplot(aes(x = intel)) +
  geom_histogram(color = "black",
                 fill = "green",
                 breaks=seq(0, 10, by = 1)) +
  scale_x_continuous(breaks=seq(0, 10, by = 1)) +
  scale_y_continuous(breaks=seq(0, 10000, by = 100)) +
  labs(x= "Quão inteligente p1 achou p2 (intel)",
       y = "Quantidade")
``` 
```{r}
dados %>%
  #na.omit(samerace) %>%
  ggplot(aes(x = attr)) +
  geom_histogram(color = "black",
                 fill = "pink",
                 breaks=seq(0, 10, by = 1)) +
  scale_x_continuous(breaks=seq(0, 10, by = 1)) +
  scale_y_continuous(breaks=seq(0, 10000, by = 100)) +
  labs(x= "Quão atraente p1 achou p2 (attr)",
       y = "Quantidade")
``` 

```{r}
dados  %>%
  ggplot(aes(y=prob, x=int_corr)) +
  geom_point(alpha = 0.1, position = position_jitter(width = 0.25), color="purple") +
  labs(
    title="C", 
    x= "Correlação entre os interesses entre as pessoas", 
    y= "Probabilidade de um novo encontro"
  ) +
  scale_x_log10() 

```  
  
Para esta análise serão escolhidas as seguintes variáveis:

`prob` : que probabiliade p1 acha que p2 tem de querer se encontrar novamente com p- (escala 1-10)
`int_corr` : correlação entre os interesses de p1 e p2
`like` : no geral, quanto p1 gostou de p2?
`intel` : quão inteligente p1 achou p2
`attr` : quão atraente p1 achou p2
--------------------------------------------------
`fun` : quão divertido p1 achou p2
`shar` : quanto p1 achou que compartilha interesses e hobbies com p2
`sinc` : quão sincero p1 achou p2
`samerace` : p1 e p2 são da mesma raça?
`intel` : quão inteligente p1 achou p2
`amb` : quão ambicioso p1 achou p2  

```{r}

#dados = dados %>% augment(type.predict = "response")

bm <- glm(match ~ int_corr + prob + like + intel + attr,
      data = dados,  
      family = "binomial")


tidy(bm, conf.int = TRUE)
tidy(bm, conf.int = TRUE, exponentiate = TRUE)

glance(bm)
pR2(bm)
``` 

```{r}
tidy(bm, conf.int = TRUE, conf.level = 0.95) %>%
  filter(term != "(Intercept)") %>%
  ggplot(aes(term, estimate, ymin = conf.low, ymax = conf.high)) +
  geom_bar(stat = "identity", position = position_dodge(0.8), fill="#00b894", alpha=0.5, width=.7) + 
  geom_errorbar(size = 0.8, width= 0.25) +
  geom_point(color = "red", size = 2) +
  geom_hline(yintercept = 0, colour = "darkred") +
  labs(x = "Variáveis Independentes",
       title = "Termos da regressão logística",
       y = expression(paste("estimado ", 'b'," (95% de confiança)")))
``` 

# Que fatores nos dados têm efeito relevante na chance do casal ter um match? Descreva se os efeitos são positivos ou negativos e sua magnitude. 

Na amostra de dados analisada...